# 游戏机制详解

本文档详细说明了游戏中核心数值的获取与计算方式。

## 1. 个人属性 (Attributes)

### 心魔 (Mind)
心魔代表修仙者内心的杂念与负面情绪，过高会阻碍修炼甚至走火入魔。
- **初始值**: 0
- **上限**: 100
- **获取方式**:
    - **增加 (负面)**:
        - **斗法 (Combat)**: 处于战斗状态时，每 tick 有 1% 概率 +1。
        - **渡劫失败**: 必定 +10。
    - **减少 (净化)**:
        - **渡劫成功**: 必定 -20 (最低至0)。
        - **顿悟 (Read)**: 阅读/工作状态触发“顿悟”时 (2% 概率)，-5。
- **影响**:
    - **修炼效率**: 当心魔 > 50 时，修炼效率开始衰减。惩罚系数 = `(心魔 - 50) * 2%`。
    - **渡劫成功率**: 每点心魔减少 0.5% 的自然渡劫成功率。

### 体魄 (Body)
体魄代表修仙者的肉身强度，直接影响承受雷劫的能力。
- **初始值**: 10
- **上限**: 无上限
- **获取方式**:
    - **增加**:
        - **渡劫成功**: +2。
    - **减少**:
        - **渡劫失败**: -1 (最低至0)。
- **影响**:
    - **渡劫成功率**: 每点体魄增加 1% 的自然渡劫成功率。

### 好感度 (Affection)
好感度代表与天道或周围环境的契合度（隐藏属性）。
- **初始值**: 0
- **上限**: 100
- **获取方式**:
    - 目前主要通过特定事件或物品修改。
- **影响**:
    - **物品掉落率**: 在“键盘历练 (KEYBOARD)”状态下，掉落率加成 = `好感度 * 0.2%`。

---

## 2. 天赋 (Talents)

天赋点用于强化修仙者的特定能力。
- **获取方式**:
    - **渡劫成功**: 每次晋升大境界，获得 +1 天赋点。
    - **洗髓**: 重置所有天赋点时返还。
- **天赋列表**:
    1. **悟性 (Exp)**:
        - **效果**: 每级增加 5% 的基础修为获取。
        - **计算**: `最终倍率 = 1.0 + (等级 * 0.05)`。
    2. **机缘 (Drop)**:
        - **效果**: 每级增加 5% 的物品掉落概率。
        - **计算**: `额外掉率 = 等级 * 0.05`。

---

## 3. 灵石 (Spirit Stones)

灵石是修仙界的通用货币。
- **获取方式**:
    1. **每日勤勉奖励**:
        - 每日根据总操作数（键盘敲击+鼠标点击）结算。
        - 操作数 < 2000: 无奖励。
        - 操作数 >= 2000: +100 灵石。
        - 操作数 >= 10000: +500 灵石。
    2. **物品出售**:
        - 在坊市中出售背包物品。
        - **售价计算**: `基础价格 * 0.5` (向下取整，最低为1)。

---

## 4. 修为 (Cultivation / Exp)

修为是提升境界的根本，通过监测用户的键鼠活动自动获取。

### 获取逻辑 (每秒判定一次, 1 tick = 1s)
系统每秒根据当前的键鼠 APM (每分钟操作数) 判定状态并发放修为。

| 状态 | 判定条件 | 基础收益 (每秒) | 基础收益 (每分钟) | 额外说明 |
| :--- | :--- | :--- | :--- | :--- |
| **摸鱼 (Idle)** | KB < 30 且 Mouse < 30 | +1 | **60** | 最低保底 |
| **历练 (Work)** | KB >= 30 | +5 | **300** | 掉落物品 |
| **悟道 (Read)** | Mouse >= 30 | +8 | **480** | 顿悟概率 |
| **斗法 (Combat)** | KB >= 30 且 Mouse >= 30 | +15 | **900** | 最高效率 |

### 常见问题
- **Q: 每一分钟挂机获得多少修为？**
    - A: 基础为 **60** 点/分钟 (1点/秒)。受天赋和心魔影响会有波动。
- **Q: 每点击一次鼠标或者键盘获得多少修为？**
    - A: **单次点击/按键不直接增加修为**。
    - 你的操作会提升 APM (操作频率)，从而让角色进入更高效率的修炼状态 (如从“摸鱼”进入“悟道”)，间接提升几十倍的获取速度。


### 离线收益
- **触发条件**: 离线时间 > 60秒。
- **计算公式**: `离线时长(秒) * 2.5`。

### 最终计算公式

---

## 5. 境界与所需修为 (Levels & Requirements)

修仙之路共有 **9** 个大境界。每个境界突破所需修为呈指数级增长。
- **计算公式**: `所需修为 = 100 * (2 ^ 当前境界层数)`

| 境界层数 | 境界名称 | 突破所需修为 |
| :--- | :--- | :--- |
| 0 | 炼气期 | 100 |
| 1 | 筑基期 | 200 |
| 2 | 金丹期 | 400 |
| 3 | 元婴期 | 800 |
| 4 | 化神期 | 1600 |
| 5 | 炼虚期 | 3200 |
| 6 | 合体期 | 6400 |
| 7 | 大乘期 | 12800 |
| 8 | 渡劫期 | 25600 |

*注: 达到“渡劫期”圆满后，再次突破有望飞升（依据版本更新可能有所变动）。*
